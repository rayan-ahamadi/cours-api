// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  ratings   Rating[]
}

enum Role {
  ADMIN
  USER
}

model Title {
  id              Int       @id @default(autoincrement())
  imdbID          String    @unique
  title           String
  year            String
  rated           String?
  released        String?
  runtime         String?
  genre           String?
  director        String?
  writer          String?
  actors          String?
  plot            String?
  language        String?
  country         String?
  awards          String?
  poster          String?
  externalRatings Json?
  metascore       String?
  imdbRating      String?
  imdbVotes       String?
  type            TitleType
  dvd             String?
  boxOffice       String?
  production      String?
  website         String?
  response        String?
  createdAt       DateTime?  @default(now())
  dataCompleted  Boolean   @default(false)
  updatedAt       DateTime   @updatedAt
  ratings         Rating[]   
}

model Rating {
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  title     Title    @relation(fields: [titleId], references: [id])
  titleId   Int
  comment   String
  rating    Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum TitleType {
  movie
  series
}
